@using proyecto2.ViewModel
@model CuestionarioHR

@{
    ViewData["Title"] = "Create";

}
<link  href="~/css/pages.css"/>
 
       <form asp-action="Create">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

             <nav class="navbar navbar-expand-md navbar-light bg-light">
        <div class="container">

           
            <div class="d-flex">
                <button value="Create" class="btn btn-success me-2 btn-style">Guardar</button>
                <button class="btn btn-danger btn-style">Cancelar</button>
            </div>
        </div>
    </nav>
    <div class="container-fluid m-0">
        <div class="row">
            <!-- Primera sección (izquierda) -->
            <div class="col-md-2 bg-white custom-left-section p-3">
                <!-- Barra de navegación izquierda -->
                <ul id="questionList" class="list-group">
                    @for(int i = 0; i < Model.Preguntas.Count; i++)
                    {
                        <li class="list-group-item d-flex justify-content-between align-items-center">
<button id="preguntaButton-@(Model.Preguntas[i].IdPregunta)" class="btn btn-primary" onclick="showPregunta(@(i))" formaction="#">
   @Model.Preguntas[i].pregunta
</button>
<button class="btn btn-danger btn-sm deleteButton">Eliminar</button>
</li>
                     
             
                    }
                  
                </ul>
                <div class="mt-3 añadirPreguntas">
                    <input type="text" id="newQuestionInput" class="form-control" placeholder="Nueva Pregunta">
                    
                </div>
                <div id="addFunctionButton" class="btn  btn-primary mt-2">
                    Agregar Pregunta
                </div>
            </div>

            <!-- Segunda sección (derecha) -->
            <div class="col-md-10 bg-white p-4">
              <div id="preguntaContenedor"></div>
                <h3>Escribe la pregunta</h3>
                <input type="text" class="form-control" asp-for="preguntatexto" placeholder="Pregunta">
                
            <div class="form-group">
                <label asp-for="IdCategoria" class="control-label">Categoria</label>
                <select asp-for="IdCategoria" class ="form-control" asp-items="ViewBag.IdCategoria"></select>
            </div>
             <label>Titulo</label>
               <div class="input-group-text">
               
                <input asp-for="Titulo" class="input"/>             
            </div>
              <div class="form-group form-check">
                <label class="form-check-label">
                    <input class="form-check-input" asp-for="Publico" /> @Html.DisplayNameFor(model => model.Publico)
                </label>
            </div>

                <p class="pt-2">Selecciona el tipo de respuesta:</p>
                <div class="mt-3 bg-card container-fluid">
                    <div class="form-check bg-card-op">
                        <input class="form-check-input" type="radio" name="respuesta" value="varias_respuestas"
                            id="varias_respuestas">
                        <label class="form-check-label" for="varias_respuestas">Varias respuestas correctas</label>
                    </div>
                    <div class="form-check bg-card-op">
                        <input class="form-check-input" type="radio" name="respuesta" value="una_respuesta"
                            id="una_respuesta">
                        <label class="form-check-label" for="una_respuesta">Solo una respuesta correcta</label>
                    </div>
                </div>
                @for (int i = 0; i < 5; i++)
                {
                    <div id="RespuestasContenedor">
                        <table class="table mt-3">

                             </table>
                            
                      </div>

                   
                  
                    }
                 <div class="form-group">
<input class="add-respuesta" type="button" value="Agregar opción" />
</div>
                
                
                   
              
               
                
            </div>
        </div>
    </div>
     </form>

<div>
    <a asp-action="Index">Back to List</a>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
     <script>
        $("#addFunctionButton").click(function () {
            console.log("si")
            $(".añadirPreguntas").append(`                    <input type="text" id="newQuestionInput" class="form-control mt-3" placeholder="Nueva Pregunta">
        `);
        });

        function agregarRespuesta() {
            let respuestasContenedor = $("#RespuestasContenedor");
            let numRespuestas = respuestasContenedor.find(".dynamic-respuesta").length;
            if (numRespuestas < 10) {
                let siguienteIndice = numRespuestas;
                let nuevaRespuesta = $(


                    ` <tr>
                              <td>
                            <div class="input-group dynamic-respuesta">
                              <input  type="text"  class="form-control"   name="Respuestas[${siguienteIndice}].respuesta" asp-for="Respuestas[${siguienteIndice}].respuesta" placeholder="Ingresa tu Respuesta aqui" />
                                             <div class="input-group-text">
                                                <input id="eye" type="checkbox" class="form-check-input"  value="True" name="Respuestas[${siguienteIndice}].RCorrecta" asp-for="Respuestas[${siguienteIndice}].RCorrecta" />
                                             </div>
                                                <button type="button" class="btn btn-danger remove-respuesta">Eliminar</button>
                                    </div>
                               </td>
                         </tr> `);
                respuestasContenedor.find("table").append(nuevaRespuesta);
            }
            else {
                alert("No se pueden agregar mas de 10 respuestas!");
            }
        }
        $(".add-respuesta").click(agregarRespuesta);


        // Eliminar respuesta
        $("#RespuestasContenedor").on("click", ".remove-respuesta", function () {
            let filarespuesta = $(this).closest("tr");
            filarespuesta.remove();
        });
    </script>
}
